<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-X97H6MRF2T"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-X97H6MRF2T');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalogue - Antiquités</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .product-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px -10px rgba(0, 0, 0, 0.15);
        }
        .aspect-card {
            aspect-ratio: 4/5;
        }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;  
            overflow: hidden;
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-900 font-sans">

    <!-- Header Section -->
    <header class="bg-white border-b border-stone-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 py-6 flex flex-col md:flex-row md:items-center justify-between gap-4">
            <div>
                <nav class="text-sm text-stone-500 mb-1">
                    <a href="../index.html" class="hover:text-stone-800 transition-colors underline underline-offset-4">Accueil</a>
                    <span class="mx-2">/</span>
                    <span id="breadcrumb-category" class="capitalize font-medium text-stone-800">Catégorie</span>
                </nav>
                <h1 id="page-title" class="text-3xl font-serif font-bold capitalize tracking-tight text-stone-800">
                    Chargement...
                </h1>
            </div>
            <div id="item-count" class="text-sm font-medium bg-stone-100 px-3 py-1 rounded-full text-stone-600">
                0 Articles
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-12">
        <!-- Error/Loading Container -->
        <div id="status-message" class="text-center py-20">
            <div class="inline-block animate-pulse text-stone-400 italic text-lg">Recherche des produits en cours...</div>
        </div>

        <!-- Product Grid -->
        <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 opacity-0 transition-opacity duration-500">
            <!-- Dynamic Content -->
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-stone-200 mt-20 py-10 bg-white">
        <div class="max-w-7xl mx-auto px-6 text-center text-stone-500 text-sm">
            &copy; 2020-2026 ECB BADEL - Tous droits réservés.
        </div>
    </footer>

    <script>
        const productsData = {
            "horlogerie": [
                { "id": "HOR-01", "name": "HORLOGE COMTOISE 01", "description": "Description détaillée", "price": "950", "category": "horlogerie", "active": true },
                { "id": "HOR-02", "name": "HORLOGE COMTOISE 02", "description": "", "price": "", "category": "horlogerie", "active": true },
                { "id": "HOR-03", "name": "HORLOGE COMTOISE", "description": "251 X 34 X 28", "price": "", "category": "horlogerie", "active": true },
                { "id": "HOR-04", "name": "HORLOGE COMTOISE", "description": "232 X 62,5 X 24", "price": "", "category": "horlogerie", "active": true },
                { "id": "HOR-05", "name": "HORLOGE COMTOISE", "description": "256 X 51 X 26,5", "price": "", "category": "horlogerie", "active": true },
                { "id": "HOR-06", "name": "HORLOGE COMTOISE", "description": "", "price": "", "category": "horlogerie", "active": true },
                { "id": "HOR-07", "name": "HORLOGE COMTOISE", "description": "STIEN AUGEZ à VIRIEU", "price": "", "category": "horlogerie", "active": true },
                { "id": "HOR-08", "name": "HORLOGE COMTOISE", "description": "Desportes à Mornant", "price": "", "category": "horlogerie", "active": true },
                { "id": "HOR-09", "name": "HORLOGE COMTOISE", "description": "H BAUDOT à COSNE", "price": "", "category": "horlogerie", "active": true },
                { "id": "HOR-10", "name": "HORLOGE COMTOISE", "description": "", "price": "", "category": "horlogerie", "active": true }
            ],
            "miroirs": [
                { "id": "MIR-01", "name": "MIROIR-01", "description": "Superbe miroir doré", "price": 380, "category": "miroirs", "active": true },
                { "id": "MIR-02", "name": "MIROIR 02", "description": "80 x 60 cm", "price": 1, "category": "miroirs", "active": true },
                { "id": "MIR-03", "name": "MIROIR-03", "description": "75 x 52 cm", "price": 1, "category": "miroirs", "active": true },
                { "id": "MIR-04", "name": "MIROIR-04", "description": "97 x 57 cm", "price": 1, "category": "miroirs", "active": true },
                { "id": "MIR-05", "name": "MIROIR-05", "description": "77 x 68 cm", "price": 1, "category": "miroirs", "active": true },
                { "id": "MIR-06", "name": "MIROIR-06", "description": "75 x 57 cm", "price": 1, "category": "miroirs", "active": true }
            ],
            "véhicules": [
                { "id": "VEH-01", "name": "LAND ROVER FREELANDER TD4", "description": "Excellent état", "price": 3200, "category": "véhicules", "active": true }
            ]
        };

        function init() {
            const grid = document.getElementById('product-grid');
            const status = document.getElementById('status-message');
            const titleElem = document.getElementById('page-title');
            const breadcrumb = document.getElementById('breadcrumb-category');
            const countElem = document.getElementById('item-count');

            // 1. Detect category from URL (e.g., .../miroirs/index.html -> 'miroirs')
            // Fallback for demo: assume 'miroirs' if not found in URL structure
            const pathParts = window.location.pathname.split('/').filter(Boolean);
            let currentCategory = pathParts.length >= 1 ? pathParts[pathParts.length - 2] : "miroirs";
            if (currentCategory==="v%C3%A9hicules") {
                currentCategory = "véhicules";
            }

            // 2. Fetch list from JSON
            const list = productsData[currentCategory] || [];
            const activeItems = list.filter(item => item.active);

            // 3. Update UI Headers
            titleElem.textContent = currentCategory;
            breadcrumb.textContent = currentCategory;
            countElem.textContent = `${activeItems.length} Article${activeItems.length > 1 ? 's' : ''}`;

            if (activeItems.length === 0) {
                status.innerHTML = `<p class="text-stone-400">Aucun produit actif dans la catégorie "${currentCategory}".</p>`;
                return;
            }

            // 4. Build Cards
            const cardsHtml = activeItems.map(item => {
                // Formatting price
                const displayPrice = item.price && item.price > 1 ? `${item.price}€` : "Prix sur demande";
                
                // Constructing Image Path: category/id/1.jpg
                const imageSrc = `../${currentCategory}/${item.id}/1.jpg`;
                
                // Removing HTML tags from description for card preview
                const cleanDesc = item.description.replace(/<[^>]*>?/gm, '').trim() || "Consulter pour plus de détails";

                return `
                <div class="product-card bg-white rounded-lg border border-stone-200 overflow-hidden flex flex-col">
                    <a href="${item.id}/index.html" class="block group overflow-hidden bg-stone-100 aspect-card relative">
                        <img 
                            src="${imageSrc}" 
                            alt="${item.name}"
                            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
                            onerror="this.src='https://placehold.co/400x500/e7e5e4/a8a29e?text=Image+Indisponible'"
                        >
                        <div class="absolute top-3 right-3 bg-white/90 backdrop-blur px-2 py-1 rounded text-[10px] font-bold tracking-widest text-stone-500 uppercase">
                            ${item.id}
                        </div>
                    </a>
                    
                    <div class="p-5 flex-grow flex flex-col">
                        <h2 class="text-lg font-serif font-bold text-stone-800 mb-2">${item.name}</h2>
                        <p class="text-stone-500 text-sm line-clamp-2 mb-4 flex-grow italic">
                            ${cleanDesc}
                        </p>
                        
                        <div class="flex items-center justify-between mt-auto pt-4 border-t border-stone-100">
                            <span class="text-base font-bold text-stone-900">${displayPrice}</span>
                            <a href="${item.id}/index.html" class="text-stone-400 hover:text-stone-800 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
                `;
            }).join('');

            // 5. Inject and Show
            grid.innerHTML = cardsHtml;
            status.classList.add('hidden');
            grid.classList.remove('opacity-0');
        }

        window.onload = init;
    </script>
</body>
</html>